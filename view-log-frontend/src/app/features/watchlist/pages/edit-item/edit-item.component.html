<div class="edit-item-container">
  <p-toast/>

  <!-- Header -->
  <header class="viewlog-header">
    <div class="header-content">
      <div class="logo">
        <i class="pi pi-video"></i>
        <span>ViewLog</span>
      </div>
    </div>
  </header>

  <!-- Body -->
  <div class="form-wrapper">
    @if (loading()) {
      <app-loading-spinner/>
    } @else {

      <div class="form-card">
        <h1 class="form-title">Edit Item</h1>

        <form [formGroup]="form" (ngSubmit)="onSubmit()">

          <!-- Name -->
          <div class="form-field">
            <label>Name</label>
            <input
              pInputText
              formControlName="name"
              placeholder="Enter title"
              class="w-full"/>
            @if (form.get('name')?.invalid && form.get('name')?.touched) {
              <small class="error-text">Name is required.</small>
            }
          </div>

          <!-- Type + Genre -->
          <div class="form-row">
            <div class="form-field">
              <label>Type</label>
              <p-select
                formControlName="type"
                [options]="typeOptions"
                optionLabel="label"
                optionValue="value"
                placeholder="Select type"
                styleClass="w-full"/>
              @if (form.get('type')?.invalid && form.get('type')?.touched) {
                <small class="error-text">Type is required.</small>
              }
            </div>

            <div class="form-field">
              <label>Genre</label>
              <p-select
                formControlName="genre"
                [options]="genreOptions"
                optionLabel="label"
                optionValue="value"
                placeholder="Select genre"
                styleClass="w-full"/>
              @if (form.get('genre')?.invalid && form.get('genre')?.touched) {
                <small class="error-text">Genre is required.</small>
              }
            </div>
          </div>

          <!-- Rating -->
          <div class="form-field">
            <label>Rating</label>
            <p-inputNumber
              formControlName="rating"
              [min]="0"
              [max]="10"
              [step]="0.1"
              placeholder="3.5"
            />
            @if (form.get('rating')?.invalid && form.get('rating')?.touched) {
              <small class="error-text">Rating must be between 0 and 10.</small>
            }
          </div>

          <!-- Watched -->
          <div class="form-field checkbox-field">
            <p-checkbox
              formControlName="watched"
              [binary]="true"
              inputId="watched"/>
            <label for="watched" class="checkbox-label">Watched</label>
          </div>

          <!-- Notes -->
          <div class="form-field">
            <label>Notes</label>
            <textarea
              pInputText
              rows="4"
              formControlName="notes"
              placeholder="Add any notes..."
              class="w-full textarea-field"></textarea>
          </div>

          <!-- Actions -->
          <div class="form-actions">
            <button
              type="button"
              class="cancel-btn"
              (click)="goBack()">
              Cancel
            </button>

            <button
              type="submit"
              class="save-btn"
              [disabled]="form.invalid || saving()">

              @if (saving()) {
                <i class="pi pi-spin pi-spinner"></i>
              }
              Save Changes
            </button>
          </div>

        </form>
      </div>
    }
  </div>

  <!-- Footer -->
  <footer class="viewlog-footer">
    <p>Â© 2023 ViewLog. All rights reserved.</p>
  </footer>
</div>
